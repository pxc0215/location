<view class="mask" wx:if="{{showMenu}}" bindtap="hideMenu"></view>

<view class="container" bindtap="hideMenu">
  <view class="header">
    <view class="user-section" catchtap="stopPropagation">
      <view class="item {{showMenu ? 'active' : ''}} {{!userName || userName === '登录' ? 'no-login' : ''}}" bindtap="showUserMenu">
        <image class="usercenter {{!userName || userName === '登录' ? 'avatar-gray' : ''}}" src="{{avatarUrl}}"></image>
        <view class="usertitle">{{userName || '请登录'}}</view>
      </view>
      
      <!-- 下拉菜单 -->
      <view class="dropdown-menu" wx:if="{{showMenu && userName && userName !== '登录'}}">
        <view class="menu-item" catchtap="toUserInfo">
          <text>个人信息</text>
        </view>
        <view class="menu-item" catchtap="handleLogout">
          <text>退出</text>
        </view>
      </view>
    </view>

    <!-- 右侧只保留历史记录按钮 -->
    <view class="right-buttons" wx:if="{{userName && userName !== '登录'}}">
      <view class="nav-btn" bindtap="toOrderList">历史记录</view>
    </view>
  </view>
  <image class="topimg_holder" bindtap="makePhoto" wx:if="{{files.length === 0}}" src="../../asset/add_photo.png"></image>
  <image class="topimg" bindtap="makePhoto" wx:if="{{files.length > 0}}" src="{{files[0].id}}"></image>
  <view class="title" bindtap="makePhoto">点击添加/修改照片</view>
  <view class="item" bindtap="tomap">
    <image class="location_icon" src="../../asset/location.png"></image>
    <view class="tips">{{address}}</view>
  </view>
  <view class="form-cell_title">备注说明(选填)</view>
  <input class="form-cell_input" placeholder="可输入详细的描述（100字以内）" placeholder-class="form-cell_title-placeholder" maxlength="100" bindinput="onDescInput" value="{{desc}}" />
  <button class="mainbtn" bindtap="submit">提交</button>
</view>